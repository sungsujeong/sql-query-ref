Refer to a SQL problem: https://www.hackerrank.com/challenges/harry-potter-and-wands/problem?isFullScreen=true

My solution:
SELECT id, age, coins_needed, power
FROM Wands W
     INNER JOIN Wands_Property WP
     ON W.code = WP.code
WHERE coins_needed = (SELECT MIN(coins_needed)
                      FROM Wands W2
                      INNER JOIN Wands_Property WP2
                      ON W2.code = WP2.code
                      WHERE WP2.is_evil = 0 AND 
                            WP2.age = WP.age AND 
                            W2.power = W.power)
ORDER BY W.power DESC, WP.age DESC;
